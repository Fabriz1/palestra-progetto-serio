<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>In Attesa</title>
    <link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#0f172a">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        body { font-family: 'Inter', sans-serif; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; background: #F5F5F7; text-align: center; padding: 20px; color: #1D1D1F; }
        .icon-box { font-size: 60px; color: #0071E3; margin-bottom: 20px; animation: pulse 2s infinite; }
        h1 { font-size: 24px; margin-bottom: 10px; }
        p { color: #86868B; line-height: 1.5; max-width: 400px; margin-bottom: 30px; }
        .btn-check { padding: 12px 24px; background: white; border: 1px solid #D2D2D7; border-radius: 12px; font-weight: 600; cursor: pointer; color: #1D1D1F; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.1); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>
    <div class="icon-box"><i class="ph ph-hourglass-high"></i></div>
    <h1>Richiesta Inviata</h1>
    <p>La tua richiesta di adesione è stata inviata al Coach. Attendi che venga accettata per accedere alla piattaforma.</p>
    <button class="btn-check" onclick="location.reload()">Controlla di nuovo</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyBCZqWbOdM2a89arMX18TMKqZI6BmeSsVQ",
            authDomain: "personal-trainer-fe4cc.firebaseapp.com",
            projectId: "personal-trainer-fe4cc",
            storageBucket: "personal-trainer-fe4cc.firebasestorage.app",
            messagingSenderId: "340774601063",
            appId: "1:340774601063:web:eeb03cd7ce0755b78aefc2",
            measurementId: "G-CEESE7YR9K"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const snap = await getDoc(doc(db, "users", user.uid));
                const data = snap.data();
                // Se lo stato non è più 'pending' (quindi è active), entra!
                if (data.status !== 'pending' && data.coachId) {
                    window.location.href = "dashboard-client.html";
                }
            } else { window.location.href = "login.html"; }
        });
    </script>
</body>
</html>